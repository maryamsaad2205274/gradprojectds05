from torch.utils.data import DataLoader, random_split

dataset = LandmarkDataset(LAB_IMG_DIR, LAB_LBL_DIR, img_size=IMG_SIZE, augment=True)

train_size = 24
val_size = len(dataset) - train_size
train_ds, val_ds = random_split(dataset, [train_size, val_size], generator=torch.Generator().manual_seed(42))

# IMPORTANT: no augmentation in validation
val_ds.dataset.augment = False

train_loader = DataLoader(train_ds, batch_size=8, shuffle=True, num_workers=2, pin_memory=True)
val_loader = DataLoader(val_ds, batch_size=8, shuffle=False, num_workers=2, pin_memory=True)

len(train_ds), len(val_ds)
